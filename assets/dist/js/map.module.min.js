/* 2016-06-28 09:21 */
!function(a){define("map-loader.provider",[],function(){"use strict";function a(){this.options={v:"3.exp",key:"",libraries:"",language:"fr"},this.configure=function(a){angular.extend(this.options,a)},this.$get=["$q","$timeout",function(a,e){function f(){window.google&&window.google.maps&&window.google.maps.LatLng?(c=!0,g.resolve()):++h<100?e(f,200):console.warn("100 iterations and no maps")}var g=a.defer(),h=0;if(window._loadGoogleMapsService=function(){f()},c)g.resolve();else if(!d){d=!0;var i="//maps.googleapis.com/maps/api/js?v="+this.options.v+"&key="+this.options.key+(this.options.libraries?"&libraries="+this.options.libraries:"")+"&callback=_loadGoogleMapsService";b(i)}return function(){return g.promise}}]}function b(a,b){var c=window.document.getElementsByTagName("script")[0],d=window.document.createElement("script");return d.src=a,d.async=!0,c.parentNode.insertBefore(d,c),b&&"function"==typeof b&&(d.onload=b),d}var c=!1,d=!1;return a}),define("map.directive",[],function(){"use strict";function a(){function a(a,c,d,e,f,g){function h(){var d=n(c);d||(d=document.createElement("div")),d&&(p.map=new google.maps.Map(d,angular.extend({},m(),a.mapOptions)),q.resolve(p.map),a.onMapReady&&a.onMapReady(p.map),google.maps.event.addListener(p.map,"bounds_changed",b(function(b){var c=p.map.getCenter(),d=p.map.getZoom();a.mapOptions&&(a.mapOptions.bounds=null,a.mapOptions.center.lat=c.lat(),a.mapOptions.center.lng=c.lng(),a.mapOptions.zoom=d),a.onMapBoundsChange&&a.onMapBoundsChange(p.map,b)},200)),a.mapOptions&&j(a.mapOptions.bounds))}function i(a){a=a||{},p.whenMapReady.then(function(b){a=angular.extend({},m(),a),"string"==typeof a.mapTypeId&&(a.mapTypeId=google.maps.MapTypeId[a.mapTypeId]),b.setOptions(a)})}function j(a){a&&p.whenMapReady.then(function(b){b.fitBounds(a)})}function k(a){a&&("lat"in a&&(a.lat=1*a.lat),"lng"in a&&(a.lng=1*a.lng),p.whenMapReady.then(function(b){b.panTo(a)}))}function l(a){p.whenMapReady.then(function(b){b.setZoom(a)})}function m(){var a={zoom:2,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,center:{lat:0,lng:0},disableDefaultUI:!1};return a}function n(a){var b;return angular.forEach(a.children(),function(a){null!==a.getAttribute("zee-map-canvas")&&(b=a)}),b}function o(b,c){p.whenMapReady.then(function(d){var e=d.getZoom(),f=d.getProjection(),g=f.fromLatLngToPoint(d.getCenter()),h=("number"==typeof b?b:0)/Math.pow(2,e)||0,i=("number"==typeof c?c:0)/Math.pow(2,e)||0,j=new google.maps.Point(h,i),k=new google.maps.Point(g.x-j.x,g.y+j.y),l=f.fromPointToLatLng(k);a.mapOptions.center.lat=l.lat(),a.mapOptions.center.lng=l.lng()})}var p=this,q=e.defer();p.whenMapReady=q.promise,p.panToOffset=o,p.setCenter=k,g().then(function(){f(h,50)}),a.$watch("mapOptions",function(a,b){if(a&&a!==b){var c=angular.extend({},b,{bounds:a.bounds,center:a.center,zoom:a.zoom});angular.equals(a,c)||i(a)}},!0),a.$watch("mapOptions.bounds",function(a,b){a!==b&&j(a)},!0),a.$watch("mapOptions.center",function(a,b){a!==b&&k(a)},!0),a.$watch("mapOptions.zoom",function(a,b){a!==b&&l(a)})}return a.$inject=["$scope","$element","$attrs","$q","$timeout","zeeMapLoader"],{scope:{mapOptions:"=zeeMapOptions",onMapReady:"=zeeMapOnReady",onMapBoundsChange:"=zeeMapOnBoundsChange"},controller:a}}function b(a,b,d){var e,f,g,h,i,j=function(){var k=c()-h;b>k&&k>=0?e=setTimeout(j,b-k):(e=null,d||(i=a.apply(g,f),e||(g=f=null)))};return function(){g=this,f=arguments,h=c();var k=d&&!e;return e||(e=setTimeout(j,b)),k&&(i=a.apply(g,f),g=f=null),i}}var c=Date.now||function(){return(new Date).getTime()};return a}),define("map-cluster.directive",["require"],function(a){"use strict";function b(){function b(a,b,c,d){function e(a){j.then(function(b){b.addMarker(a),google.maps.event.addListener(a,"position_changed",g)})}function f(a){j.then(function(b){b.removeMarker(a),g()})}function g(){j.then(function(a){var b=a.getMarkers();a.clearMarkers(),a.addMarkers(b)})}var h=this,i=d.defer(),j=i.promise;h.addMarker=e,h.refreshCluster=g,h.removeMarker=f,a.$watch("cluster",function(a){a&&(h.cluster=a,i.resolve(h.cluster))})}return b.$inject=["$scope","$element","$attrs","$q"],{require:"^zeeMap",scope:{clusterOptions:"=zeeMapClusterOptions"},compile:function(){return{post:angular.noop,pre:function(b,c,d,e){e.whenMapReady.then(function(c){a(["./plugins/marker-clusterer"],function(){var a=[{url:"/img/map/cluster-1.png",width:53,height:72,anchor:[20,0],textColor:"#ffffff",textSize:10},{url:"/img/map/cluster-2.png",width:56,height:77,anchor:[22,0],textColor:"#ff0000",textSize:11},{url:"/img/map/cluster-3.png",width:66,height:91,anchor:[26,0],textColor:"#ffffff",textSize:12}];a=[{url:"/img/map/cluster.png",width:68,height:86,anchor:[18,0],textColor:"#75a84c",textSize:24}];var d=angular.extend({gridSize:60,maxZoom:20,styles:a},b.clusterOptions);b.cluster=new MarkerClusterer(c,[],d),google.maps.event.addListener(b.cluster,"clusterclick",function(){}),b.$$phase||b.$apply()})})}}},controller:b}}return b}),define("map-marker.directive",[],function(){"use strict";function a(){function a(a,b,c,d){var e=this,f=d.defer();e.whenMarkerReady=f.promise,e.marker=null,a.$watch("marker",function(a){a&&!e.marker&&(e.marker=a,f.resolve(e.marker))})}return a.$inject=["$scope","$element","$attrs","$q"],{require:["^zeeMap","?^zeeMapCluster"],scope:{markerOptions:"=zeeMapMarkerOptions",markerPosition:"=?zeeMapMarkerPosition",markerClass:"=?zeeMapMarkerClass",onClick:"&zeeMapMarkerOnClick"},link:function(a,b,c,d){function e(a){return a&&"string"!=typeof a?(a.url2x,"size"in a&&(a.size=new google.maps.Size(a.size.width,a.size.height)),"scaledSize"in a&&(a.scaledSize=new google.maps.Size(a.scaledSize.width,a.scaledSize.height)),"origin"in a&&(a.origin=new google.maps.Point(a.origin.x,a.origin.y)),"anchor"in a&&(a.anchor=new google.maps.Point(a.anchor.x,a.anchor.y)),a):a}function f(){h.whenMapReady.then(function(){a.marker&&(a.markerOptions.icon=e(a.markerOptions.icon),a.marker.setOptions({icon:a.markerOptions.icon}))})}function g(b){"lat"in b&&(b.lat=1*b.lat),"lng"in b&&(b.lng=1*b.lng),h.whenMapReady.then(function(){a.marker&&a.marker.setPosition(b)})}var h=d[0],i=d[1];a.$watch("markerOptions",function(b){!a.marker&&b&&h.whenMapReady.then(function(b){a.markerOptions.icon=e(a.markerOptions.icon),a.markerClass||(a.markerClass=google.maps.Marker),a.marker=new a.markerClass(a.markerOptions),i?i.addMarker(a.marker):a.marker.setMap(b),a.onClick&&google.maps.event.addListener(a.marker,"click",function(){a.onClick(),a.$$phase||a.$apply()})})},!0),a.$watch("markerOptions.position",function(a,b){a!==b&&g(a)},!0),a.$watch("markerOptions.icon.url",function(a,b){a!==b&&f(a)}),a.$watch("markerPosition",function(a){a&&g(a)},!0),a.$on("$destroy",function(){h.whenMapReady.then(function(){a.marker&&(a.marker.setMap(null),i&&i.removeMarker(a.marker))})})},controller:a}}return a}),define("map-infobox.directive",["require"],function(b){"use strict";function c(c){var d=[];return{require:["^zeeMap","^zeeMapMarker"],scope:{infoboxOptions:"=zeeMapInfoboxOptions",onClose:"&zeeMapInfoboxOnClose"},link:function(e,f,g,h){function i(a){return e.infobox.div_?a(e.infobox.div_):void setTimeout(function(){i(a)},200)}var j=h[0],k=h[1];e.infobox=null,e.infoboxes=d;var l=a(window).width()>=960;k.whenMarkerReady.then(function(a){j.setCenter({lat:a.position.lat(),lng:a.position.lng()}),l?j.panToOffset(160,0):j.panToOffset(0,-160),b(["./plugins/infobox"],function(){var b=300;l&&(b=460),e.infobox=new InfoBox({alignBottom:!0,content:f.html(),disableAutoPan:!1,maxWidth:b,pixelOffset:new google.maps.Size(-b/2,-32),zIndex:null,boxStyle:{width:b+"px"}});for(var d=0;d<e.infoboxes.length;d++)e.infoboxes[d].close();e.infoboxes.push(e),e.infobox.open(a.getMap(),a),e.infobox.setVisible(!0),e.$parent.$on("$destroy",function(){e.close()}),i(function(a){var b=a.children[1].children[0];b&&(e.$parent.close=e.close,c(b)(e.$parent),e.$$phase||e.$apply(),b.className=b.className.replace("hidden",""),setTimeout(function(){b.getBoundingClientRect},100))})})}),e.open=function(){e.infobox&&e.infobox.setVisible(!0)},e.close=function(){if(e.infobox){var a=e.infoboxes.indexOf(e);-1!==a&&e.infoboxes.splice(a,1),e.infobox.setVisible(!1),e.onClose&&e.onClose()}}}}}return c.$inject=["$compile"],c}),define("map-search.directive",[],function(){"use strict";function a(a){function b(a){var b=this;a.$watch("autocompleteFromText",function(a){b.autocompleteFromText=a})}return b.$inject=["$scope"],{require:"^zeeMap",scope:{searchOptions:"=zeeMapSearchOptions",onStateChange:"=zeeMapSearchOnStateChange",onPlaceChange:"=zeeMapSearchOnPlaceChange",onGeometryChange:"=zeeMapSearchOnGeometryChange"},link:function(b,c,d,e){function f(a){a&&a.geometry&&(b.geometry=a.geometry),a&&!a.geometry&&a.name&&g(a.name)}function g(a){a=a||i.value,a&&(h("pending"),e.whenMapReady.then(function(c){j||(j=new google.maps.places.AutocompleteService),j.getPlacePredictions({input:a},function(a){var d;if(a&&a.length)for(var e=0;e<a.length;e++)!d&&a[0].place_id&&(d=a[0].place_id);d?(k||(k=new google.maps.places.PlacesService(c)),k.getDetails({placeId:d},function(a){a&&a.geometry?(b.place=a,b.$$phase||b.$apply(),h("success")):h("fail")})):h("fail")})}))}function h(a){b.onStateChange&&(b.onStateChange(a),b.$$phase||b.$apply())}var i=c[0];"input"!==i.tagName.toLowerCase()&&(i=c.find("input")[0]),i||console.error("zeeMapSearch","No input element found"),b.autocomplete=null,b.place=null,b.geometry=null,b.autocompleteFromText=g;var j=null,k=null;e.whenMapReady.then(function(){if(i.value&&a(function(){g(i.value)},100),b.autocomplete=new google.maps.places.Autocomplete(i,b.searchOptions||{types:["geocode"],componentRestrictions:{country:"FR"}}),i.dispatchEvent&&null!==i.getAttribute("autofocus")){var c=document.createEvent("CustomEvent");c.initCustomEvent("keydown",!1,!1,null),setTimeout(function(){i.dispatchEvent(c)},500)}google.maps.event.addListener(b.autocomplete,"place_changed",function(){if(b.place=b.autocomplete.getPlace(),b.place.formatted_address&&(i.value=b.place.formatted_address,i.dispatchEvent)){var a=document.createEvent("CustomEvent");a.initCustomEvent("change",!1,!1,null),i.dispatchEvent(a)}b.$$phase||b.$apply()})}),b.$watch("place",function(a,c){a!==c&&(b.onPlaceChange&&b.onPlaceChange(a),f(a))}),b.$watch("geometry",function(a,c){a!==c&&b.onGeometryChange&&b.onGeometryChange(a)})},controller:b}}return a.$inject=["$timeout"],a}),define("map-search-button.directive",[],function(){"use strict";function a(){return{require:"^zeeMapSearch",link:function(a,b,c,d){b.on("click",function(){d.autocompleteFromText()})}}}return a}),define("map.module",["./map-loader.provider","./map.directive","./map-cluster.directive","./map-marker.directive","./map-infobox.directive","./map-search.directive","./map-search-button.directive"],function(a,b,c,d,e,f,g){"use strict";return angular.module("zee.map",[]).provider("zeeMapLoader",a).directive("zeeMap",b).directive("zeeMapCluster",c).directive("zeeMapMarker",d).directive("zeeMapInfobox",e).directive("zeeMapSearch",f).directive("zeeMapSearchButton",g)}),requirejs.config({shim:{},paths:{angular:"../../bower_components/angular/angular",requirejs:"../../bower_components/requirejs/require"},packages:[]}),define("require.conf",function(){})}(jQuery);